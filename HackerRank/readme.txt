lots of code for a mid ass f1 score
