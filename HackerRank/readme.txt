lots of code for a mid f1 score
